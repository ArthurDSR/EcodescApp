"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8620],{8620:(C,h,o)=>{o.r(h),o.d(h,{EDescartePageModule:()=>k});var f=o(2200),p=o(4341),c=o(9420),m=o(8132),i=o(8244),v=o(839),a=o(3664),u=o(4192),E=o(5032),x=o(9330),M=o(3665);let y=(()=>{class e{constructor(t,r,s,l,d,n,U){this.router=t,this.formBuilder=r,this.toastController=s,this.activatedRoute=l,this.navController=d,this.http=n,this.ecopontoService=U,this.markers=[],this.latitude=0,this.longitude=0,this.ecopontos=[]}ngOnInit(){this.registrarLocalizacao().then(()=>{this.carregarEcopontos()}).catch(t=>{console.error("Erro ao obter localiza\xe7\xe3o:",t),this.latitude=-23.5505,this.longitude=-46.6333,this.carregarEcopontos()})}carregarEcopontos(){this.ecopontoService.listarTodos().subscribe({next:t=>{this.ecopontos=t,this.setupLeafletIcons(),setTimeout(()=>{this.createMap()},500),this.map&&this.addMarkersToMap()},error:t=>{console.error("Erro ao carregar ecopontos:",t)}})}registrarLocalizacao(){return new Promise((t,r)=>{v.L.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4,maximumAge:0}).then(s=>{this.latitude=s.coords.latitude,this.longitude=s.coords.longitude,console.log("Localiza\xe7\xe3o obtida:",this.latitude,this.longitude),t()}).catch(s=>{console.error("Erro ao obter localiza\xe7\xe3o:",s),r(s)})})}createMap(){try{this.clearMarkers(),this.map=i.map("map").setView([this.latitude,this.longitude],13),i.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xa9 OpenStreetMap contributors"}).addTo(this.map);const t=i.divIcon({className:"user-location-marker",html:'<div style="background-color: #007bff; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 10px rgba(0,0,0,0.3);"></div>',iconSize:[20,20],iconAnchor:[10,10]});i.marker([this.latitude,this.longitude],{icon:t}).bindPopup("Sua localiza\xe7\xe3o atual").addTo(this.map),setTimeout(()=>{this.addMarkersToMap(),this.map&&this.map.invalidateSize()},200)}catch(t){console.error("Erro ao criar mapa:",t)}}setupLeafletIcons(){delete i.Icon.Default.prototype._getIconUrl,i.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"})}addMarkersToMap(){this.clearMarkers(),this.ecopontos.forEach((t,r)=>{if(t.coordenadas){const s=t.coordenadas.split(",");if(2===s.length){const l=parseFloat(s[0].trim()),d=parseFloat(s[1].trim());if(!isNaN(l)&&!isNaN(d))try{const n=i.marker([l,d]).bindPopup(`\n                  <div>\n                    <h3>${t.nome}</h3>\n                    <p>${t.descricao||"Sem descri\xe7\xe3o"}</p>\n                  </div>\n                `).addTo(this.map);this.markers.push(n)}catch(n){console.error("Erro ao adicionar marcador:",n)}}}})}clearMarkers(){this.markers.forEach(t=>{this.map&&this.map.removeLayer(t)}),this.markers=[]}static#t=this.\u0275fac=function(r){return new(r||e)(a.rXU(u.Ix),a.rXU(p.ok),a.rXU(c.K_),a.rXU(u.nX),a.rXU(E.q9),a.rXU(x.Qq),a.rXU(M.p))};static#a=this.\u0275cmp=a.VBU({type:e,selectors:[["app-e-descarte"]],standalone:!1,decls:11,vars:0,consts:[["color","transparent"],[1,"ion-padding"],[1,"descricao-container"],["src","../../../assets/icon/Rectangle 26.svg","alt","ecoponto","width","100%","height","auto"],[1,"descricao"],[1,"map-container"],["id","map",1,"map"]],template:function(r,s){1&r&&(a.nrm(0,"ion-toolbar",0),a.j41(1,"ion-content",1)(2,"div",2),a.nrm(3,"img",3),a.j41(4,"p",4),a.EFF(5,"\xc9 aqui uma das principais \xe1reas da nossa plataforma. Esta p\xe1gina foi planejada para informar pontos seguros para descarte de res\xedduos de equipamentos eletroeletr\xf4nicos e os demais tipos de lixo."),a.nrm(6,"br")(7,"br"),a.EFF(8," No mapa abaixo, voc\xea consegue analisar e encontrar o Ecoponto mais perto de voc\xea:"),a.k0s()(),a.j41(9,"div",5),a.nrm(10,"div",6),a.k0s()())},dependencies:[c.W9,c.ai],styles:[".descricao[_ngcontent-%COMP%]{font-size:20px;line-height:1.5}.descricao-container[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px;text-align:justify}"]})}return e})();var g=o(8728);const b=[{path:"",component:y}];let j=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#a=this.\u0275mod=a.$C({type:e});static#o=this.\u0275inj=g.G2t({imports:[m.iI.forChild(b),m.iI]})}return e})(),k=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#a=this.\u0275mod=a.$C({type:e});static#o=this.\u0275inj=g.G2t({imports:[f.MD,p.YN,c.bv,j]})}return e})()}}]);